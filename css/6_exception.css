@layer exception {
  /* === DRAWER DIRECTIONS === */
  
  /* Left drawer */
  [class*="drawer:left"] {
    top: 0;
    left: 0;
    width: var(--drawer-width);
    max-width: var(--drawer-maxwidth);
    height: 100vh;
    transform: translateX(-100%);
  }
  
  [class*="drawer:left"][open],
  [class*="drawer:left"]:popover-open {
    opacity: 1;
    transform: translateX(0);
  }
  
  @starting-style {
    [class*="drawer:left"][open],
    [class*="drawer:left"]:popover-open {
      opacity: 0;
      transform: translateX(-100%);
    }
  }

  /* Right drawer */
  [class*="drawer:right"] {
    top: 0;
    right: 0;
    width: var(--drawer-width);
    max-width: var(--drawer-maxwidth);
    height: 100vh;
    transform: translateX(100%);
  }
  
  [class*="drawer:right"][open],
  [class*="drawer:right"]:popover-open {
    opacity: 1;
    transform: translateX(0);
  }
  
  @starting-style {
    [class*="drawer:right"][open],
    [class*="drawer:right"]:popover-open {
      opacity: 0;
      transform: translateX(100%);
    }
  }

  /* Top drawer */
  [class*="drawer:top"] {
    top: 0;
    left: 0;
    width: 100vw;
    height: var(--drawer-height);
    max-height: var(--drawer-maxheight);
    transform: translateY(-100%);
  }
  
  [class*="drawer:top"][open],
  [class*="drawer:top"]:popover-open {
    opacity: 1;
    transform: translateY(0);
  }
  
  @starting-style {
    [class*="drawer:top"][open],
    [class*="drawer:top"]:popover-open {
      opacity: 0;
      transform: translateY(-100%);
    }
  }

  /* Bottom drawer */
  [class*="drawer:bottom"] {
    bottom: 0;
    left: 0;
    width: 100vw;
    height: var(--drawer-height);
    max-height: var(--drawer-maxheight);
    transform: translateY(100%);
  }
  
  [class*="drawer:bottom"][open],
  [class*="drawer:bottom"]:popover-open {
    opacity: 1;
    transform: translateY(0);
  }
  
  @starting-style {
    [class*="drawer:bottom"][open],
    [class*="drawer:bottom"]:popover-open {
      opacity: 0;
      transform: translateY(100%);
    }
  }

  /* === DRAWER BACKDROP (dialog only) === */
  dialog[class*="drawer:"]::backdrop {
    background: var(--drawer-backdrop);
    transition: 
      opacity 0.3s, 
      overlay 0.3s allow-discrete, 
      display 0.3s allow-discrete;
    opacity: 0;
  }
  
  dialog[class*="drawer:"][open]::backdrop {
    opacity: 1;
  }
  
  @starting-style {
    dialog[class*="drawer:"][open]::backdrop {
      opacity: 0;
    }
  }

  /* === BUTTON VARIANTS === */
  [class~="btn:pri"], [class*="btn:pri-"] {
    --_btn-color: var(--color-pri);
    background: var(--_btn-color);
    color: var(--color-pri-text);
    border: 1.5px solid light-dark(
      color-mix(in oklch, var(--_btn-color), black 15%),
      color-mix(in oklch, var(--_btn-color), white 20%)
    );
  }
  [class~="btn:sec"], [class*="btn:sec-"] {
    --_btn-color: var(--color-sec);
    background: var(--_btn-color);
    color: var(--color-sec-text);
    border: 1.5px solid light-dark(
      color-mix(in oklch, var(--_btn-color), black 15%),
      color-mix(in oklch, var(--_btn-color), white 20%)
    );
  }
  [class~="btn:wrn"], [class*="btn:wrn-"] {
    --_btn-color: var(--color-wrn);
    background: var(--_btn-color);
    color: var(--color-wrn-text);
    border: 1.5px solid light-dark(
      color-mix(in oklch, var(--_btn-color), black 15%),
      color-mix(in oklch, var(--_btn-color), white 20%)
    );
  }
  [class~="btn:dgr"], [class*="btn:dgr-"] {
    --_btn-color: var(--color-dgr);
    background: var(--_btn-color);
    color: var(--color-dgr-text);
    border: 1.5px solid light-dark(
      color-mix(in oklch, var(--_btn-color), black 15%),
      color-mix(in oklch, var(--_btn-color), white 20%)
    );
  }


  /* === BUTTON SIZES === */
  [class$="-sm"], [class*="-sm "] {
    &:is([class*="btn:"]) {
      height: var(--btn-height-sm);
      padding-inline: var(--space-sm);
      font-size: var(--text-sm);
    }
    &:is([class*="chip:"]) {
      height: var(--size-4);
      padding-inline: var(--space-xs);
      font-size: var(--text-xxs, 0.65rem);
    }
  }
  [class$="-lg"], [class*="-lg "] {
    &:is([class*="btn:"]) {
      height: var(--btn-height-lg);
      padding-inline: var(--space-lg);
      font-size: var(--text-lg);
    }
  }

  /* === ICON BUTTON SIZE === */
  /* === ICON BUTTON VARIANTS === */
  [class~="icon-btn:mute"], [class*="icon-btn:mute-"] {
    color: var(--text-muted);
  }

  /* === ICON BUTTON SIZES === */
  [class$="-sm"], [class*="-sm "] {
    &:is([class*="icon-btn:"]) {
      width: var(--size-px-7);
      & svg { width: var(--size-px-4); height: var(--size-px-4); }
    }
  }

  /* === OUT MODIFIER (works on any colored element) === */
  [class~="out"] {
    background: color-mix(in oklch, var(--_btn-color, currentColor), transparent 92%);
    color: var(--_btn-color, currentColor);
    border: 1.5px solid currentColor;
  }

  /* === BUTTON STATES === */
  :is(button, [class~="btn"], [class*="btn:"], [class~="icon-btn"], [class*="icon-btn:"]) {
    &[aria-busy="true"] { opacity: 0.7; cursor: wait; }
    &:disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }
  }

  /* === BADGE VARIANTS === */
  .badge {
    &.suc { background: var(--color-suc); color: var(--color-suc-text, white); }
    &.wrn { background: var(--color-wrn); color: var(--color-wrn-text, white); }
    &.dgr { background: var(--color-dgr); color: var(--color-dgr-text, white); }
  }

  /* === TABS VARIANTS === */
  [class~="tabs:pri"], [class*="tabs:pri-"] {
    --_tabs-color: var(--color-pri);
  }
  [class~="tabs:sec"], [class*="tabs:sec-"] {
    --_tabs-color: var(--color-sec);
  }

  /* === TABS SIZES === */
  [class$="-sm"], [class*="-sm "] {
    &:is([class*="tabs:"]) {
      padding: 3px;
      gap: 2px;
      & [class~="tab"], & [class*="tab:"] {
        padding: var(--space-xxs, 0.25rem) var(--space-sm);
        font-size: var(--text-xs);
      }
    }
  }

  /* === TABS FULL WIDTH === */
  [class$="-full"], [class*="-full "] {
    &:is([class*="tabs:"]) {
      display: flex;
      width: 100%;
      & [class~="tab"], & [class*="tab:"] {
        flex: 1;
        text-align: center;
      }
    }
  }

  /* === CHIP VARIANTS === */
  [class~="chip:inf"], [class*="chip:inf-"] {
    background: light-dark(
      color-mix(in oklch, var(--blu-5), var(--gry-0) 85%),
      color-mix(in oklch, var(--blu-7), var(--gry-8) 80%)
    );
    color: light-dark(
      color-mix(in oklch, var(--blu-7), var(--gry-9) 30%),
      color-mix(in oklch, var(--blu-3), var(--gry-1) 20%)
    );
    border-color: light-dark(
      color-mix(in oklch, var(--blu-5), transparent 60%),
      color-mix(in oklch, var(--blu-6), transparent 50%)
    );
  }
  [class~="chip:suc"], [class*="chip:suc-"] {
    background: light-dark(
      color-mix(in oklch, var(--grn-5), var(--gry-0) 85%),
      color-mix(in oklch, var(--grn-7), var(--gry-8) 80%)
    );
    color: light-dark(
      color-mix(in oklch, var(--grn-8), var(--gry-9) 30%),
      color-mix(in oklch, var(--grn-3), var(--gry-1) 20%)
    );
    border-color: light-dark(
      color-mix(in oklch, var(--grn-5), transparent 60%),
      color-mix(in oklch, var(--grn-6), transparent 50%)
    );
  }
  [class~="chip:wrn"], [class*="chip:wrn-"] {
    background: light-dark(
      color-mix(in oklch, var(--yel-7), var(--gry-0) 70%),
      color-mix(in oklch, var(--yel-7), var(--gry-8) 65%)
    );
    color: light-dark(
      color-mix(in oklch, var(--yel-9), var(--gry-9) 40%),
      color-mix(in oklch, var(--yel-2), var(--gry-1) 30%)
    );
    border-color: light-dark(
      color-mix(in oklch, var(--yel-5), transparent 50%),
      color-mix(in oklch, var(--yel-6), transparent 40%)
    );
  }
  [class~="chip:dgr"], [class*="chip:dgr-"] {
    background: light-dark(
      color-mix(in oklch, var(--red-7), var(--gry-0) 70%),
      color-mix(in oklch, var(--red-7), var(--gry-8) 65%)
    );
    color: light-dark(
      color-mix(in oklch, var(--red-7), var(--gry-9) 30%),
      color-mix(in oklch, var(--red-3), var(--gry-1) 20%)
    );
    border-color: light-dark(
      color-mix(in oklch, var(--red-5), transparent 60%),
      color-mix(in oklch, var(--red-6), transparent 50%)
    );
  }

  /* === TAG SIZES === */
  [class$="-sm"], [class*="-sm "] {
    &:is([class*="tag:"]) {
      height: var(--size-4);
      padding-inline: var(--space-xs);
      font-size: var(--text-xxs, 0.65rem);
    }
  }

  /* === CARD VARIANTS === */
  .card {
    &.pri {
      background: light-dark(
        color-mix(in oklch, var(--color-pri), var(--gry-0) 94%),
        color-mix(in oklch, var(--color-pri), var(--gry-9) 92%)
      );
      border-color: light-dark(
        color-mix(in oklch, var(--color-pri), transparent 85%),
        color-mix(in oklch, var(--color-pri), transparent 80%)
      );
    }
    &.sec {
      background: light-dark(
        color-mix(in oklch, var(--color-sec), var(--gry-0) 94%),
        color-mix(in oklch, var(--color-sec), var(--gry-9) 92%)
      );
      border-color: light-dark(
        color-mix(in oklch, var(--color-sec), transparent 85%),
        color-mix(in oklch, var(--color-sec), transparent 80%)
      );
    }
    &.gla {
      background: light-dark(
        color-mix(in oklch, white, transparent 20%),
        color-mix(in oklch, var(--gry-8), transparent 40%)
      );
      backdrop-filter: blur(12px);
      border-color: light-dark(
        color-mix(in oklch, white, transparent 50%),
        color-mix(in oklch, var(--gry-6), transparent 70%)
      );
      box-shadow:
        0 1px 2px 0 rgb(0 0 0 / 0.05),
        inset 0 1px 0 0 light-dark(rgb(255 255 255 / 0.5), rgb(255 255 255 / 0.05));
    }
  }

  /* === CARD ALERT VARIANTS === */
  [class*="card:alert"] {
    &.inf { 
      background: light-dark(color-mix(in oklch, var(--color-inf), var(--gry-0) 95%), color-mix(in oklch, var(--color-inf), var(--gry-9) 95%));
      border-color: var(--color-inf); 
      box-shadow: 0 0 0 2px color-mix(in oklch, var(--color-inf), transparent 80%); 
    }
    &.suc { 
      background: light-dark(color-mix(in oklch, var(--color-suc), var(--gry-0) 95%), color-mix(in oklch, var(--color-suc), var(--gry-9) 95%));
      border-color: var(--color-suc); 
      box-shadow: 0 0 0 2px color-mix(in oklch, var(--color-suc), transparent 80%); 
    }
    &.wrn { 
      background: light-dark(color-mix(in oklch, var(--color-wrn), var(--gry-0) 95%), color-mix(in oklch, var(--color-wrn), var(--gry-9) 95%));
      border-color: var(--color-wrn); 
      box-shadow: 0 0 0 2px color-mix(in oklch, var(--color-wrn), transparent 80%); 
    }
    &.dgr { 
      background: light-dark(color-mix(in oklch, var(--color-dgr), var(--gry-0) 95%), color-mix(in oklch, var(--color-dgr), var(--gry-9) 95%));
      border-color: var(--color-dgr); 
      box-shadow: 0 0 0 2px color-mix(in oklch, var(--color-dgr), transparent 80%); 
    }
    &.res {
      resize: horizontal;
      overflow: auto;
      border: 1px dashed var(--gry-6);
      min-width: 250px;
      max-width: 100%;
    }
  }

  /* === INPUT VALIDATION STATES === */
  input:is([type="text"], [type="email"], [type="password"], [type="search"], [type="tel"], [type="url"], [type="number"]),
  input:not([type]),
  textarea {
    &.err {
      border-color: var(--color-err);
      &:focus { box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-err), transparent 85%); }
    }
    &.suc {
      border-color: var(--color-suc);
      &:focus { box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-suc), transparent 85%); }
    }
    &.wrn {
      border-color: var(--color-wrn);
      &:focus { box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-wrn), transparent 85%); }
    }
    &.inf {
      border-color: var(--color-inf);
      &:focus { box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-inf), transparent 85%); }
    }
  }

  /* === VERTICAL DIVIDERS === */
  hr[class*="vert"] {
    inline-size: 1px;
    block-size: auto;
    align-self: stretch;
    margin-block: 0;
    margin-inline: var(--space-md);
  }

}
}